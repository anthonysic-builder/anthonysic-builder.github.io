<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pvt. Paul F. Costa | WWII Service Record</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&family=Merriweather:wght@300;400;700;900&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'paper': '#f4f1ea',
                        'paper-dark': '#e5e0d4',
                        'od-green': '#4b5320',
                        'navy-dark': '#1e293b',
                        'brass': '#b38b4d',
                        'ink': '#2c2c2c',
                        'archive-note-bg': '#fcfbf7', 
                    },
                    fontFamily: {
                        'serif': ['Merriweather', 'serif'],
                        'sans': ['Open Sans', 'sans-serif'],
                        'mono': ['Courier Prime', 'monospace'],
                    },
                    boxShadow: {
                        'photo': '0 4px 6px -1px rgba(0, 0, 0, 0.5), 0 2px 4px -1px rgba(0, 0, 0, 0.3)',
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #f4f1ea; color: #2c2c2c; }
        html { scroll-behavior: smooth; }
        
        /* Photo Border Effect - UPDATED: Rotation removed */
        .photo-frame {
            background-color: white;
            padding: 8px;
            box-shadow: 2px 2px 10px rgba(0,0,0,0.4);
            transform: rotate(0deg); /* Straightened photo */
            transition: transform 0.3s ease;
        }
        .photo-frame:hover { transform: scale(1.02); }

        /* Timeline Styles */
        .timeline-line {
            background-image: linear-gradient(#b38b4d 50%, rgba(255,255,255,0) 0%);
            background-position: right;
            background-size: 2px 20px;
            background-repeat: repeat-y;
            width: 2px;
        }

        .reveal { opacity: 0; transform: translateY(30px); transition: all 0.8s ease-out; }
        .reveal.active { opacity: 1; transform: translateY(0); }

        /* Map & Markers */
        .vintage-map .leaflet-layer { filter: grayscale(100%) sepia(30%) contrast(90%); transition: filter 0.5s ease; }
        .vintage-map:hover .leaflet-layer { filter: grayscale(0%) sepia(0%); }

        .number-icon {
            display: flex; align-items: center; justify-content: center;
            background-color: #1e293b; color: #b38b4d; border: 2px solid #b38b4d;
            border-radius: 50%; font-family: 'Courier Prime', monospace;
            font-weight: bold; font-size: 14px; box-shadow: 2px 2px 0px rgba(0,0,0,0.3);
        }

        .path-flow { animation: dash-flow 1s linear infinite; }
        @keyframes dash-flow { to { stroke-dashoffset: -20; } }
        
        /* Map Popup Styling */
        .leaflet-popup-content-wrapper { background: #f4f1ea; border-radius: 2px; border: 2px solid #b38b4d; padding: 0; }
        .leaflet-popup-content { margin: 10px; }
        .leaflet-popup-tip { background: #b38b4d; }
    </style>
</head>
<body class="antialiased">

    <nav class="fixed top-0 w-full bg-navy-dark text-paper z-50 shadow-md bg-opacity-95 backdrop-blur-sm border-b-2 border-brass">
        <div class="container mx-auto px-6 py-3 flex justify-between items-center">
            <span class="font-mono text-sm tracking-widest uppercase text-brass font-bold">Official File</span>
            <div class="space-x-6 text-sm font-semibold tracking-wide">
                <a href="#overview" class="hover:text-brass transition">Overview</a>
                <a href="#timeline" class="hover:text-brass transition">Timeline</a>
                <a href="#awards" class="hover:text-brass transition">Decorations</a>
            </div>
        </div>
    </nav>

    <header class="bg-navy-dark text-paper pt-32 pb-24 relative overflow-hidden border-b-8 border-brass">
        <div class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/stardust.png')]"></div>
        <div class="container mx-auto px-4 text-center relative z-10 reveal active">
            
            <p class="font-mono text-brass mb-2 tracking-widest text-sm uppercase">Service Record</p>
            <h1 class="text-4xl md:text-7xl font-black mb-2 tracking-tight font-serif text-white">Private Paul F. Costa</h1>
            <p class="text-xl md:text-2xl text-gray-400 font-light tracking-wide mb-8 font-sans">U.S. Army | MOS 931 (Truck Driver, Heavy) | 1943–1945</p>

            <div class="flex flex-col md:flex-row items-center justify-center gap-12 mt-12">
                <div class="group hidden md:block opacity-80 hover:opacity-100 transition">
                     <img src="images/8th-af.png" alt="8th Air Force" class="h-24 w-auto drop-shadow-lg filter brightness-90">
                </div>

                <div class="photo-frame max-w-[220px] mx-auto z-20">
                    <img src="images/paul-costa.jpg" alt="Pvt. Paul Costa" class="w-full h-auto filter sepia-[.3] contrast-110 grayscale-[.2]">
                </div>

                <div class="group hidden md:block opacity-80 hover:opacity-100 transition">
                     <img src="images/7th-army.png" alt="7th Army" class="h-24 w-auto object-contain drop-shadow-lg filter brightness-90">
                </div>
            </div>

            <div class="flex md:hidden justify-center gap-8 mt-8 opacity-80">
                 <img src="images/8th-af.png" alt="8th Air Force" class="h-16 w-auto">
                 <img src="images/7th-army.png" alt="7th Army" class="h-16 w-auto object-contain">
            </div>

            <div class="mt-10">
                <div class="inline-block bg-paper text-ink px-6 py-2 shadow-lg transform rotate-1 border border-gray-400">
                    <p class="text-xs font-bold font-mono uppercase tracking-tight">Separation Date: 16 Nov 1945 | Fort Belvoir, VA</p>
                </div>
            </div>
        </div>
    </header>

    <section id="overview" class="py-24 bg-paper">
        <div class="container mx-auto px-6 max-w-4xl text-center reveal">
            <div class="w-16 h-1 bg-brass mx-auto mb-8"></div>
            <h2 class="text-3xl font-bold text-ink mb-10 font-serif">Historical Overview</h2>
            <div class="prose prose-lg mx-auto text-gray-700 leading-relaxed">
                <p class="mb-6">
                    The World War II service of <span class="font-bold text-od-green">Pvt. Paul Costa</span> spans two distinct phases of the European conflict. Entering active service in March 1943, he first served as a heavy vehicle operator with the <strong>3rd Strategic Air Depot (8th Air Force)</strong>, based at Watton, England. 
                </p>
                <p class="mb-6">
                    In October 1944, he deployed to <strong>France</strong> with the <strong>19th Mobile Repair & Reclamation Squadron</strong>, supporting forward airfields at Coulommiers and Valenciennes before returning to England.
                </p>
                <p>
                    In early 1945, he transferred to the Ground Forces, eventually joining the <strong>257th Engineer Combat Battalion</strong> (7th Army) in <strong>Wassertrüdingen, Germany</strong>. He served through V-E Day and the subsequent occupation, utilizing his logistics skills to assist in the reconstruction of the American Occupation Zone.
                </p>
            </div>
        </div>
    </section>

    <section class="bg-paper-dark border-y border-gray-300 shadow-inner">
        <div class="w-full relative group h-[600px] vintage-map" id="map-container">
            <div id="map" class="h-full w-full z-0"></div>
            
            <div class="absolute bottom-6 left-6 right-6 md:left-auto md:right-10 md:w-96 bg-paper p-6 shadow-2xl border-t-4 border-brass z-[500] pointer-events-none md:pointer-events-auto">
                <div class="flex items-center gap-3 mb-2">
                    <span class="w-3 h-3 rounded-full bg-red-600 animate-pulse"></span>
                    <h3 class="font-bold text-ink text-sm font-mono uppercase">Deployment Vector</h3>
                </div>
                <p class="text-xs text-gray-600 font-sans leading-relaxed">
                    Interactive visualization derived from Separation Records (Form 100) and Unit Morning Reports. Click numbered markers to view Unit and Date details at each station.
                </p>
            </div>
        </div>
    </section>

    <section id="timeline" class="py-24 bg-paper">
        <div class="container mx-auto px-4 max-w-6xl">
            <div class="text-center mb-16 reveal">
                <h2 class="text-3xl font-bold text-ink font-serif mb-2">Service Chronology</h2>
                <p class="font-mono text-sm text-gray-500 uppercase tracking-wide">Data Source: Morning Reports & WD AGO Form 100</p>
            </div>
            
            <div class="relative">
                <div class="timeline-line absolute left-8 md:left-1/2 top-0 bottom-0 transform md:-translate-x-1/2 bg-gray-300"></div>

                <div class="relative mb-20 md:grid md:grid-cols-2 md:gap-16 items-center reveal">
                    <div class="absolute left-8 md:left-1/2 w-4 h-4 bg-paper border-4 border-navy-dark rounded-full transform -translate-x-1/2 z-10 shadow-lg"></div>
                    <div class="pl-20 md:pl-0 md:text-right mb-4 md:mb-0">
                        <h3 class="text-2xl font-bold text-ink font-mono">22 Mar 1943</h3>
                        <div class="inline-block bg-blue-100 text-blue-800 text-xs font-bold px-2 py-1 uppercase rounded mt-1 font-mono">Induction</div>
                    </div>
                    <div class="pl-20 md:pl-0">
                        <div class="bg-white p-8 shadow-[6px_6px_0px_0px_rgba(0,0,0,0.1)] border border-gray-200 hover:border-blue-400 transition-colors duration-300">
                            <h4 class="font-bold text-lg mb-2 text-ink">Camp Lee, Virginia</h4>
                            <p class="text-gray-600 text-sm leading-relaxed">Entered Active Service. Completed Quartermaster School. Qualified as <strong>Truck Driver, Heavy (MOS 931)</strong>.</p>
                        </div>
                    </div>
                </div>

                <div class="relative mb-20 md:grid md:grid-cols-2 md:gap-16 items-center reveal">
                    <div class="absolute left-8 md:left-1/2 w-4 h-4 bg-paper border-4 border-brass rounded-full transform -translate-x-1/2 z-10 shadow-lg"></div>
                    <div class="pl-20 md:pl-0 md:text-right md:row-start-1">
                         <div class="bg-white p-8 shadow-[-6px_6px_0px_0px_rgba(0,0,0,0.1)] border border-gray-200 hover:border-brass transition-colors duration-300">
                            <h4 class="font-bold text-lg mb-2 text-ink">Watton, England</h4>
                            <p class="text-gray-600 text-sm leading-relaxed">Arrived ETO. Assigned to <strong>52nd Station Comp. Sq</strong> (3rd Strategic Air Depot). Drove heavy convoys hauling aircraft engines and rations, including long-haul runs to Scotland.</p>
                        </div>
                    </div>
                    <div class="pl-20 md:pl-0 mb-4 md:mb-0 md:row-start-1">
                         <h3 class="text-2xl font-bold text-ink font-mono">08 Jan 1944</h3>
                         <div class="inline-block bg-amber-100 text-amber-800 text-xs font-bold px-2 py-1 uppercase rounded mt-1 font-mono">Strategic Air Depot</div>
                    </div>
                </div>

                <div class="relative mb-20 md:grid md:grid-cols-2 md:gap-16 items-center reveal">
                    <div class="absolute left-8 md:left-1/2 w-4 h-4 bg-paper border-4 border-blue-600 rounded-full transform -translate-x-1/2 z-10 shadow-lg"></div>
                    <div class="pl-20 md:pl-0 md:text-right mb-4 md:mb-0">
                        <h3 class="text-2xl font-bold text-ink font-mono">19 Oct 1944</h3>
                        <div class="inline-block bg-blue-100 text-blue-800 text-xs font-bold px-2 py-1 uppercase rounded mt-1 font-mono">Forward Deployment</div>
                    </div>
                    <div class="pl-20 md:pl-0">
                        <div class="bg-white p-8 shadow-[6px_6px_0px_0px_rgba(0,0,0,0.1)] border border-gray-200 hover:border-blue-400 transition-colors duration-300">
                            <h4 class="font-bold text-lg mb-2 text-ink">Coulommiers & Valenciennes, France</h4>
                            <p class="text-gray-600 text-sm leading-relaxed">Deployed to the continent with the <strong>19th Mobile R&R Sq</strong> to support forward airfields (Stations B-58 & A-83). Returned to England Nov 18, 1944.</p>
                        </div>
                    </div>
                </div>

                <div class="relative mb-20 md:grid md:grid-cols-2 md:gap-16 items-center reveal">
                    <div class="absolute left-8 md:left-1/2 w-4 h-4 bg-paper border-4 border-orange-500 rounded-full transform -translate-x-1/2 z-10 shadow-lg"></div>
                    <div class="pl-20 md:pl-0 md:text-right md:row-start-1">
                         <div class="bg-white p-8 shadow-[-6px_6px_0px_0px_rgba(0,0,0,0.1)] border border-gray-200 hover:border-orange-400 transition-colors duration-300">
                            <h4 class="font-bold text-lg mb-2 text-ink">12th Reinforcement Depot</h4>
                            <p class="text-gray-600 text-sm leading-relaxed">Transferred from Air Corps to Ground Forces for infantry/engineer retraining during the "Repl Depple" shuffle to support the final push into Germany.</p>
                        </div>
                    </div>
                    <div class="pl-20 md:pl-0 mb-4 md:mb-0 md:row-start-1">
                         <h3 class="text-2xl font-bold text-ink font-mono">28 Jan 1945</h3>
                         <div class="inline-block bg-orange-100 text-orange-800 text-xs font-bold px-2 py-1 uppercase rounded mt-1 font-mono">Reclassification</div>
                    </div>
                </div>

                <div class="relative mb-20 md:grid md:grid-cols-2 md:gap-16 items-center reveal">
                    <div class="absolute left-8 md:left-1/2 w-4 h-4 bg-paper border-4 border-red-700 rounded-full transform -translate-x-1/2 z-10 shadow-lg"></div>
                    <div class="pl-20 md:pl-0 md:text-right mb-4 md:mb-0">
                        <h3 class="text-2xl font-bold text-ink font-mono">03 May 1945</h3>
                        <div class="inline-block bg-red-100 text-red-800 text-xs font-bold px-2 py-1 uppercase rounded mt-1 font-mono">Combat Engineers</div>
                    </div>
                    <div class="pl-20 md:pl-0">
                        <div class="bg-white p-8 shadow-[6px_6px_0px_0px_rgba(0,0,0,0.1)] border border-gray-200 hover:border-red-400 transition-colors duration-300">
                            <h4 class="font-bold text-lg mb-2 text-ink">Wassertrüdingen, Germany</h4>
                            <p class="text-gray-600 text-sm leading-relaxed">Assigned to <strong>257th Engineer Combat Battalion</strong> just days before the end of the war. Moved to Aichach, Germany for V-E Day (May 8).</p>
                        </div>
                    </div>
                </div>

                <div class="relative mb-20 md:grid md:grid-cols-2 md:gap-16 items-center reveal">
                    <div class="absolute left-8 md:left-1/2 w-4 h-4 bg-paper border-4 border-od-green rounded-full transform -translate-x-1/2 z-10 shadow-lg"></div>
                    <div class="pl-20 md:pl-0 md:text-right md:row-start-1">
                         <div class="bg-white p-8 shadow-[-6px_6px_0px_0px_rgba(0,0,0,0.1)] border border-gray-200 hover:border-od-green transition-colors duration-300">
                            <h4 class="font-bold text-lg mb-2 text-ink">Occupation Duty</h4>
                            <p class="text-gray-600 text-sm leading-relaxed">Stationed in <strong>Nordlingen</strong> and <strong>Sulzbach</strong>. Promoted to PFC. Transferred to Marburg depot in August 1945 for return to USA.</p>
                        </div>
                    </div>
                    <div class="pl-20 md:pl-0 mb-4 md:mb-0 md:row-start-1">
                         <h3 class="text-2xl font-bold text-ink font-mono">Summer 1945</h3>
                         <div class="inline-block bg-green-100 text-green-900 text-xs font-bold px-2 py-1 uppercase rounded mt-1 font-mono">Germany</div>
                    </div>
                </div>
                
                 <div class="relative mb-4 md:grid md:grid-cols-2 md:gap-16 items-center reveal">
                    <div class="absolute left-8 md:left-1/2 w-4 h-4 bg-gray-800 rounded-full transform -translate-x-1/2 z-10"></div>
                    <div class="pl-20 md:pl-0 md:text-right mb-4 md:mb-0">
                        <h3 class="text-2xl font-bold text-ink font-mono">16 Nov 1945</h3>
                        <div class="inline-block bg-gray-200 text-gray-700 text-xs font-bold px-2 py-1 uppercase rounded mt-1 font-mono">Honorable Discharge</div>
                    </div>
                    <div class="pl-20 md:pl-0">
                         <div class="bg-transparent border-l-4 border-gray-400 pl-6">
                            <h4 class="font-bold text-lg mb-1 text-ink">Fort Belvoir, Virginia</h4>
                            <p class="text-gray-600 text-sm italic">Service concludes at Separation Center.</p>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <section id="awards" class="py-24 bg-paper-dark border-t border-gray-300">
        <div class="container mx-auto px-4 max-w-7xl reveal">
            <div class="text-center mb-16">
                <h2 class="text-3xl font-bold text-ink font-serif mb-4">Awards & Decorations</h2>
                <p class="text-gray-600 italic">"For Honorable and Faithful Service"</p>
            </div>
            
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-8">
                <script>
                    const renderCard = (id, img, title, subtitle, borderHover, imgClass = 'max-h-12') => {
                        document.write(`
                            <div onclick="openModal('${id}')" class="bg-white p-6 rounded-sm shadow-md cursor-pointer hover:shadow-xl hover:-translate-y-1 transition-all duration-300 group relative overflow-hidden border-b-4 border-transparent hover:${borderHover}">
                                <div class="absolute top-0 right-0 p-2 opacity-0 group-hover:opacity-100 transition text-gray-400">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                </div>
                                <div class="flex flex-col items-center h-full justify-between">
                                    <div class="flex-grow flex items-center justify-center w-full mb-4">
                                        <img src="${img}" alt="${title}" class="${imgClass} w-auto drop-shadow-sm filter contrast-110">
                                    </div>
                                    <div class="text-center">
                                        <h3 class="font-bold text-ink text-sm leading-tight mb-1 font-serif group-hover:text-brass transition-colors">${title}</h3>
                                        <p class="text-[10px] uppercase tracking-wider text-gray-500 font-bold font-mono">${subtitle}</p>
                                    </div>
                                </div>
                            </div>
                        `);
                    };
                </script>

                <script>
                    renderCard('goodconduct', 'images/good-conduct.png', 'Good Conduct', 'Efficiency & Fidelity', 'border-red-800');
                    renderCard('americancampaign', 'images/american-campaign.png', 'American Campaign', 'Domestic Service', 'border-blue-400');
                    renderCard('eame', 'images/eame.png', 'EAME Campaign', '1 Bronze Star', 'border-yellow-600');
                    renderCard('victory', 'images/victory.png', 'WWII Victory', 'Active Service', 'border-red-600');
                    renderCard('occupation', 'images/occupation.png', 'Army of Occupation', 'Germany Clasp', 'border-black');
                    renderCard('muc', 'images/muc.png', 'Meritorious Unit', '257th Engineers', 'border-red-600');
                    renderCard('driver', 'images/driver.png', 'Driver & Mechanic', 'Driver-W Bar', 'border-gray-500', 'max-h-16');
                    renderCard('marksman', 'images/marksman.png', 'Marksman Badge', 'Rifle Component', 'border-gray-500', 'max-h-16');
                </script>
            </div>
        </div>
    </section>

    <footer class="bg-navy-dark text-gray-400 py-16 text-center border-t-8 border-brass">
        <div class="container mx-auto px-6">
            <h4 class="text-brass font-serif font-bold text-lg mb-4">Pvt. Paul F. Costa (1943-1945)</h4>
            <div class="w-16 h-px bg-gray-700 mx-auto mb-6"></div>
            <p class="text-xs font-mono opacity-60 leading-relaxed max-w-lg mx-auto">
                All historical data compiled from National Archives & Records Administration (NARA) 
                Morning Reports, Separation Qualification Record (Form 100), Discharge Documents (WD AGO 53-55), and 
                Department of Veterans Affairs records.
            </p>
        </div>
    </footer>

    <div id="modal" class="modal opacity-0 pointer-events-none fixed inset-0 z-[2000] flex items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0 bg-navy-dark opacity-80 backdrop-blur-sm" onclick="closeModal()"></div>
        <div class="bg-paper w-full max-w-lg mx-auto rounded-sm shadow-2xl z-50 transform scale-95 transition-transform duration-200" id="modal-panel">
            <div class="border-b-2 border-brass bg-paper-dark px-6 py-4 flex justify-between items-center">
                <h3 class="text-xl font-serif font-bold text-ink" id="modal-title">Title</h3>
                <button onclick="closeModal()" class="text-gray-500 hover:text-red-700 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            
            <div class="p-8">
                <div class="font-sans text-gray-700 leading-relaxed text-sm" id="modal-body"></div>
            </div>

            <div class="bg-paper-dark px-6 py-4 flex justify-end">
                 <button onclick="closeModal()" class="px-6 py-3 bg-navy-dark text-white text-xs font-bold uppercase tracking-wider hover:bg-black transition rounded-sm shadow-lg">Close Record</button>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
    <script>
        const revealElements = document.querySelectorAll('.reveal');
        const revealObserver = new IntersectionObserver((entries) => {
            entries.forEach((entry) => {
                if(entry.isIntersecting) {
                    entry.target.classList.add('active');
                }
            });
        }, { threshold: 0.1 });
        revealElements.forEach(el => revealObserver.observe(el));

        var map = L.map('map', {
            scrollWheelZoom: false,
            zoomControl: false 
        }).setView([50.0, 5.0], 5); 
        L.control.zoom({ position: 'topright' }).addTo(map);

        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; OpenStreetMap &copy; CARTO',
            maxZoom: 19
        }).addTo(map);

        var locations = [
            { id: 1, name: "Camp Lee, VA", date: "Mar 22, 1943", unit: "QM School (Basic)", coords: [37.23, -77.33] },
            { id: 2, name: "Watton, England", date: "Jan 8, 1944", unit: "3rd Strategic Air Depot", coords: [52.57, 0.82] },
            { id: 3, name: "Coulommiers, France", date: "Oct 19, 1944", unit: "19th Mobile R&R Sq", coords: [48.81, 3.08] },
            { id: 4, name: "Valenciennes, France", date: "Nov 14, 1944", unit: "19th Mobile R&R Sq", coords: [50.35, 3.52] },
            { id: 5, name: "Wassertrüdingen, Germany", date: "May 3, 1945", unit: "257th Eng. Combat Bn", coords: [49.04, 10.60] },
            { id: 6, name: "Aichach, Germany", date: "May 8, 1945", unit: "V-E Day Location", coords: [48.46, 11.13] },
            { id: 7, name: "Fort Belvoir, VA", date: "Nov 16, 1945", unit: "Separation Center", coords: [38.71, -77.14] }
        ];

        var latlngs = locations.map(loc => loc.coords);
        var polyline = L.polyline(latlngs, {
            color: '#b38b4d', weight: 3, opacity: 1, dashArray: '10, 10', lineCap: 'round', className: 'path-flow'
        }).addTo(map);

        locations.forEach(function(loc) {
            var numberIcon = L.divIcon({
                className: 'bg-transparent',
                html: `<div class="number-icon w-8 h-8 rounded-full bg-navy-dark text-white border-2 border-brass flex items-center justify-center font-bold font-mono shadow-md z-50">${loc.id}</div>`,
                iconSize: [32, 32], iconAnchor: [16, 16], popupAnchor: [0, -16]
            });
            var popupContent = `<div class="text-center font-sans p-2"><div class="font-bold text-ink uppercase tracking-wide text-xs mb-1">${loc.name}</div><div class="text-brass font-bold font-mono text-[10px] mb-2">${loc.date}</div><div class="bg-gray-100 text-gray-600 text-[10px] p-1 rounded border border-gray-300">Unit: ${loc.unit}</div></div>`;
            L.marker(loc.coords, { icon: numberIcon }).addTo(map).bindPopup(popupContent);
        });

        map.fitBounds(polyline.getBounds(), {padding: [50, 50]});

        // Award Data
        const noteBox = (label, text) => `<div class="bg-archive-note-bg p-5 border-l-4 border-brass mt-6 shadow-sm"><p class="font-bold text-brass text-xs uppercase tracking-wider mb-2">${label}</p><p class="text-sm text-gray-700 leading-relaxed font-sans">${text}</p></div>`;

        const awardData = {
            'eame': { 
                title: 'EAME Campaign Medal', 
                body: `<p><strong>Criteria:</strong> Awarded to service members who performed military duty in the European Theater (to include North Africa and the Middle East) between Dec 7, 1941, and Mar 2, 1946.</p>${noteBox('Archive Note:', 'Discharge form (WD AGO 53-55) records 1 Bronze Service Star, signifying participation in the "Central Europe" campaign.')}` 
            },
            'occupation': { 
                title: 'Army of Occupation Medal', 
                body: `<p><strong>Criteria:</strong> Awarded for service for 30 consecutive days in the occupation of Germany (May 9, 1945 – May 5, 1955).</p>${noteBox('Service Record:', 'Issued with the "Germany" Clasp. Served in the American Occupation Zone (Sulzbach/Marburg) immediately following V-E Day.')}` 
            },
            'goodconduct': { 
                title: 'Good Conduct Medal', 
                body: `<p><strong>Criteria:</strong> Awarded to any active-duty enlisted member of the United States military who completes three consecutive years of "honorable and faithful service" or one year of service during a time of war.</p>${noteBox('Archive Note:', 'Awarded for efficiency, honor, and fidelity. Completed 32 months of continuous active service.')}` 
            },
            'victory': { 
                title: 'World War II Victory Medal', 
                body: `<p><strong>Criteria:</strong> Awarded to any member of the United States military who served on active duty between December 7, 1941, and December 31, 1946.</p>${noteBox('Archive Note:', 'Recognizes active duty service during the World War II period.')}` 
            },
            'americancampaign': { 
                title: 'American Campaign Medal', 
                body: `<p><strong>Criteria:</strong> Awarded to service members who performed military duty within the American Theater of Operations between December 7, 1941, and March 2, 1946.</p>${noteBox('Service Record:', 'Acknowledges service within CONUS (Continental United States) prior to departure for England in Jan 1944.')}` 
            },
            'driver': { 
                title: 'Driver & Mechanic Badge', 
                body: `<p><strong>Criteria:</strong> Awarded to drivers and mechanics who demonstrate a high degree of skill in the operation and maintenance of military vehicles.</p>${noteBox('Qualification Record:', 'Qualified as Heavy Truck Driver (MOS 931) and Rifleman (745). Qualification form states: "Drove Army vehicles from 4-ton trucks to 10-ton semi trailers. Hauled rations on long hauls from England to Scotland."')}` 
            },
            'marksman': { 
                title: 'Marksman Badge', 
                body: `<p><strong>Criteria:</strong> Awarded to soldiers who obtain a qualifying score in a prescribed weapon course.</p>${noteBox('Qualification Record:', 'Qualified with the Service Rifle (M1 Garand) at basic training.')}` 
            },
            'muc': { 
                title: 'Meritorious Unit Commendation', 
                body: `<div class="italic text-gray-500 mb-2 font-serif text-sm">"For exceptionally meritorious conduct in the performance of outstanding services..."</div>${noteBox('Unit History:', 'The 257th Engineer Combat Battalion (H&S Company) distinguished itself during the Rhineland campaign, maintaining vital supply routes and bridges under combat conditions.')}` 
            }
        };

        function openModal(awardKey) {
            const modal = document.getElementById('modal');
            const panel = document.getElementById('modal-panel');
            const title = document.getElementById('modal-title');
            const body = document.getElementById('modal-body');
            
            if(awardData[awardKey]) {
                title.innerHTML = awardData[awardKey].title;
                body.innerHTML = awardData[awardKey].body;
                modal.classList.remove('opacity-0', 'pointer-events-none');
                panel.classList.replace('scale-95', 'scale-100');
                document.body.classList.add('modal-active');
            }
        }
        function closeModal() {
            const modal = document.getElementById('modal');
            const panel = document.getElementById('modal-panel');
            modal.classList.add('opacity-0', 'pointer-events-none');
            panel.classList.replace('scale-100', 'scale-95');
            document.body.classList.remove('modal-active');
        }
        document.addEventListener('keydown', function(event){
            if(event.key === "Escape"){ closeModal(); }
        });
    </script>
</body>
</html>
